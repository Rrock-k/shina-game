# –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –¥–æ–ª–≥ (Tech Debt)

## üîÑ –ê–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏

### üêõ –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –û–®–ò–ë–ö–ê: –õ–æ–≥–∏–∫–∞ —Ä–∞—Å—á–µ—Ç–∞ –≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–µ–±—ã–≤–∞–Ω–∏—è (2024-12-19)

**–ü—Ä–æ–±–ª–µ–º–∞**: –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è –ª–æ–≥–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –≤ `StateManager.updateStayTimer()`, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–∏–≤–æ–¥–∏–ª–∞ –∫ —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–º—É —É–±—ã–≤–∞–Ω–∏—é —Ç–∞–π–º–µ—Ä–∞ –ø—Ä–µ–±—ã–≤–∞–Ω–∏—è.

**–ö–æ—Ä–Ω–µ–≤–∞—è –ø—Ä–∏—á–∏–Ω–∞**: –í —Å—Ç—Ä–æ–∫–µ 186 `StateManager.js` —Ñ—É–Ω–∫—Ü–∏—è –≤—ã—á–∏—Ç–∞–ª–∞ –æ–±—â–µ–µ –ø—Ä–æ—à–µ–¥—à–µ–µ –≤—Ä–µ–º—è –∏–∑ –æ—Å—Ç–∞–≤—à–µ–≥–æ—Å—è –≤—Ä–µ–º–µ–Ω–∏ —Å –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –∫–∞–¥—Ä–∞, –≤–º–µ—Å—Ç–æ –≤—ã—á–∏—Ç–∞–Ω–∏—è –∏–∑ –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ–π –ø–æ–ª–Ω–æ–π –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**: 
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ —Å–≤–æ–π—Å—Ç–≤–æ `stayTotalDuration` –≤ `StateManager` –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ–π –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –∞–ª–≥–æ—Ä–∏—Ç–º —Ä–∞—Å—á–µ—Ç–∞ –≤ `updateStayTimer()` - —Ç–µ–ø–µ—Ä—å –≤—ã—á–∏—Ç–∞–µ—Ç—Å—è –∏–∑ –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ–π –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –≤ `Game.js` –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ `stayTotalDuration` –ø—Ä–∏ –ø—Ä–∏–±—ã—Ç–∏–∏
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ—á–∏—Å—Ç–∫–∞ `stayTotalDuration` –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –ø—É–Ω–∫—Ç—É

**–§–∞–π–ª—ã**:
- `src/game/StateManager.js` - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ —Ä–∞—Å—á–µ—Ç–∞
- `src/game/Game.js` - –¥–æ–±–∞–≤–ª–µ–Ω–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–æ–ª–Ω–æ–π –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

**–°—Ç–∞—Ç—É—Å**: ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û** - –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∞

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: **–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô** - –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —Å–∏–º—É–ª—è—Ü–∏–∏ –≤—Ä–µ–º–µ–Ω–∏

---

### üéØ –ù–û–í–´–ô –ü–õ–ê–ù –†–ï–§–ê–ö–¢–û–†–ò–ù–ì–ê: –°–¢–ê–ë–ò–õ–ò–ó–ê–¶–ò–Ø –ò–ì–†–û–í–û–ô –õ–û–ì–ò–ö–ò (2024-12-19)

**–ü—Ä–æ–±–ª–µ–º–∞**: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π —Å–∫–æ—Ä–æ—Å—Ç—å—é –∏–≥—Ä—ã: "–ø—Ä–æ—Å–∫–∞–∫–∏–≤–∞–Ω–∏–µ" (overshooting) –ø—É–Ω–∫—Ç–æ–≤ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è –∏ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –≤—Ä–µ–º—è –ø—Ä–µ–±—ã–≤–∞–Ω–∏—è –≤ –ª–æ–∫–∞—Ü–∏—è—Ö.

**–¶–µ–ª—å**: –°–¥–µ–ª–∞—Ç—å –∏–≥—Ä–æ–≤—É—é —Å–∏–º—É–ª—è—Ü–∏—é –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ–π –∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ–π –Ω–∞ –ª—é–±–æ–π —Å–∫–æ—Ä–æ—Å—Ç–∏ (x1, x2, x5), –æ–±–µ—Å–ø–µ—á–∏–≤ –Ω–∞–¥–µ–∂–Ω–æ–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–µ –∏–≥—Ä–æ–≤–æ–π –ª–æ–≥–∏–∫–∏ –ø—Ä–∏–±—ã—Ç–∏—è.

**–°–≤—è–∑–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã**:
- `src/systems/MovementController.js` - –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –¥–≤–∏–∂–µ–Ω–∏—è –º–∞—à–∏–Ω—ã
- `src/game/Game.js` - –≥–ª–∞–≤–Ω—ã–π –∫–ª–∞—Å—Å –∏–≥—Ä—ã
- `src/game/JournalManager.js` - –º–µ–Ω–µ–¥–∂–µ—Ä –∂—É—Ä–Ω–∞–ª–∞
- `src/game/StateManager.js` - –º–µ–Ω–µ–¥–∂–µ—Ä —Å–æ—Å—Ç–æ—è–Ω–∏—è

**–≠—Ç–∞–ø—ã —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞**:

#### ‚úÖ –≠—Ç–∞–ø 1: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ª–æ–≥–∏–∫–∏ "–ø—Ä–æ—Å–∫–∞–∫–∏–≤–∞–Ω–∏—è" (Overshooting)
- **1.1 –£–ª—É—á—à–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Å–µ–≥–º–µ–Ω—Ç–∞ –ø—É—Ç–∏**
  - –ò–∑–º–µ–Ω–∏—Ç—å –ª–æ–≥–∏–∫—É —Ç–∞–∫, —á—Ç–æ–±—ã –∏–∑–±—ã—Ç–æ—á–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å –¥–≤–∏–∂–µ–Ω–∏—è –≤ –æ–¥–Ω–æ–º –∫–∞–¥—Ä–µ –Ω–µ —Ç–µ—Ä—è–ª—Å—è, –∞ –ø–µ—Ä–µ–Ω–æ—Å–∏–ª—Å—è –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π —Å–µ–≥–º–µ–Ω—Ç
  - –§–∞–π–ª—ã: `src/systems/MovementController.js` (—Å—Ç—Ä–æ–∫–∏ 169-202)
  - –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: **–í–´–°–û–ö–ò–ô**

- **1.2 –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≤—ã–∑–æ–≤ –ª–æ–≥–∏–∫–∏ –ø—Ä–∏–±—ã—Ç–∏—è**
  - –û–±–µ—Å–ø–µ—á–∏—Ç—å, —á—Ç–æ–±—ã –ª–æ–≥–∏–∫–∞ –ø—Ä–∏–±—ã—Ç–∏—è (`checkArrival`) –≤—ã–∑—ã–≤–∞–ª–∞—Å—å –≤ —Ç–æ–º –∂–µ –∫–∞–¥—Ä–µ, –∫–æ–≥–¥–∞ –º–∞—à–∏–Ω–∞ –¥–æ—Å—Ç–∏–≥–∞–µ—Ç –∫–æ–Ω—Ü–∞ –ø—É—Ç–∏
  - –§–∞–π–ª—ã: `src/systems/MovementController.js`
  - –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: **–í–´–°–û–ö–ò–ô**

#### ‚úÖ –≠—Ç–∞–ø 2: –û–±–µ—Å–ø–µ—á–µ–Ω–∏–µ –∞—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è
- **2.1 –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–∞—Ü–∏—è –ª–æ–≥–∏–∫–∏ –ø—Ä–∏–±—ã—Ç–∏—è**
  - –°–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –¥–µ–π—Å—Ç–≤–∏—è, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –ø—Ä–∏–±—ã—Ç–∏–µ–º –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ
  - –§–∞–π–ª—ã: `src/game/Game.js` (–º–µ—Ç–æ–¥ `checkArrival()`)
  - –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: **–°–†–ï–î–ù–ò–ô**

- **2.2 –£—Ç–æ—á–Ω–µ–Ω–∏–µ –ª–æ–≥–∏–∫–∏ —Ç–∞–π–º–µ—Ä–∞ –ø—Ä–µ–±—ã–≤–∞–Ω–∏—è**
  - –£–ª—É—á—à–∏—Ç—å –ª–æ–≥–∏–∫—É —Ä–∞—Å—á–µ—Ç–∞ —Ç–∞–π–º–µ—Ä–∞, —á—Ç–æ–±—ã –æ–Ω–∞ –±—ã–ª–∞ –Ω–µ–≤–æ—Å–ø—Ä–∏–∏–º—á–∏–≤–∞ –∫ —Ñ–ª—É–∫—Ç—É–∞—Ü–∏—è–º delta
  - –§–∞–π–ª—ã: `src/game/StateManager.js`, `src/game/Game.js`
  - –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: **–°–†–ï–î–ù–ò–ô**

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è**:
- [x] –®–∏–Ω–∞ —Å—Ç–∞–±–∏–ª—å–Ω–æ –≤—ã—Ö–æ–¥–∏—Ç –∏–∑ –º–∞—à–∏–Ω—ã –≤–æ –≤—Å–µ—Ö –ª–æ–∫–∞—Ü–∏—è—Ö –Ω–∞ –≤—Å–µ—Ö —Å–∫–æ—Ä–æ—Å—Ç—è—Ö (x1, x2, x5) ‚úÖ
- [x] "–ñ—É—Ä–Ω–∞–ª –ø–æ–µ–∑–¥–æ–∫" –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∏ –±–µ–∑ –ø—Ä–æ–ø—É—Å–∫–æ–≤ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –≤—Å–µ —ç—Ç–∞–ø—ã –º–∞—Ä—à—Ä—É—Ç–∞ ‚úÖ
- [x] –í—Ä–µ–º—è, –∫–æ—Ç–æ—Ä–æ–µ –®–∏–Ω–∞ –ø—Ä–æ–≤–æ–¥–∏—Ç –≤ –∫–∞–∂–¥–æ–π –ª–æ–∫–∞—Ü–∏–∏, —Ç–æ—á–Ω–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—é `stayHours` –≤ `ROUTE_SCHEDULE` ‚úÖ
- [x] –û–±—â–µ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ —Å–∏–º—É–ª—è—Ü–∏–∏ —Å—Ç–∞–ª–æ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–º –∏ –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–π —Å–∫–æ—Ä–æ—Å—Ç–∏ –∏–≥—Ä—ã ‚úÖ

**–°—Ç–∞—Ç—É—Å**: ‚úÖ **–ó–ê–í–ï–†–®–ï–ù** - –í—Å–µ —ç—Ç–∞–ø—ã –ø–ª–∞–Ω–∞ —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏–∏ —É—Å–ø–µ—à–Ω–æ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã!

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: **–í–´–°–û–ö–ò–ô** - –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ –∏–≥—Ä–æ–≤–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞

---

## üìö –ê—Ä—Ö–∏–≤ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π

–í—Å–µ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω—ã –≤ –∞—Ä—Ö–∏–≤:
- **–§–∞–π–ª –∞—Ä—Ö–∏–≤–∞**: `docs/done-refactor-plans/refactoring-completed-archive.md`
- **–°–æ–¥–µ—Ä–∂–∏—Ç**: –í—Å–µ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ —ç—Ç–∞–ø—ã —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
- **–î–∞—Ç–∞ –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏—è**: 2024-12-19

### –û—Å–Ω–æ–≤–Ω—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è (–∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω—ã):
- ‚úÖ –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è —á–µ—Ä–µ–∑ StateManager
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (DependencyContainer)
- ‚úÖ –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- ‚úÖ –ü–æ–ª–Ω–∞—è –º–æ–¥—É–ª—å–Ω–æ—Å—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º —Å–æ —Å–≤–µ—Ç–æ—Ñ–æ—Ä–∞–º–∏
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º —Å –æ—Å—Ç–∞–Ω–æ–≤–∫–æ–π –ø–µ—Ä–µ–¥ —Å–≤–µ—Ç–æ—Ñ–æ—Ä–∞–º–∏

---

## üéØ –¢–µ–∫—É—â–∏–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã

1. **–í—ã—Å–æ–∫–∏–π**: –°—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä–æ–≤–æ–π –ª–æ–≥–∏–∫–∏ –∏ —Ç–æ—á–Ω–æ—Å—Ç—å –ø—Ä–∏–±—ã—Ç–∏—è
2. **–°—Ä–µ–¥–Ω–∏–π**: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
3. **–ù–∏–∑–∫–∏–π**: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: 2024-12-19  
**–°—Ç–∞—Ç—É—Å**: –ê–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏ –æ—á–∏—â–µ–Ω—ã, –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω—ã
