# –ü–ª–∞–Ω —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞: –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–∞—Ü–∏—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–≥—Ä–æ–π (–û—Å—Ç–∞–≤—à–∏–µ—Å—è –∑–∞–¥–∞—á–∏)

## üéØ –¶–µ–ª—å
–ó–∞–≤–µ—Ä—à–∏—Ç—å —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥, –ø–µ—Ä–µ–Ω–µ—Å—è –≤—Å—é –ª–æ–≥–∏–∫—É —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è, —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –∏ –∏–≥—Ä–æ–≤—ã–º —Ü–∏–∫–ª–æ–º –∏–∑ `main.js` –≤ –Ω–æ–≤—ã–π –∫–ª–∞—Å—Å `Game.js`, –∫–∞–∫ —ç—Ç–æ –±—ã–ª–æ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ –≤ `docs/final-architecture.md`. `main.js` –¥–æ–ª–∂–µ–Ω —Å—Ç–∞—Ç—å —Ç–æ–Ω–∫–æ–π —Ç–æ—á–∫–æ–π –≤—Ö–æ–¥–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ.

## üìã –°—Ç–∞—Ç—É—Å
- **–û—Å—Ç–∞–≤—à–∏–µ—Å—è –∑–∞–¥–∞—á–∏**: –≠—Ç–∞–ø—ã 4-6 (—á–∞—Å—Ç–∏—á–Ω–æ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã)

## üîó –°–≤—è–∑–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
- **–ö–∞—Ä—Ç–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π**: `function-dependencies.md`

## üö® –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ó–ê–î–ê–ß–ò

### 4.12 –£–¥–∞–ª–∏—Ç—å –¥—É–±–ª–∏—Ä—É—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏–∑ main.js ‚úÖ (–í–´–ü–û–õ–ù–ï–ù–û)
- ‚úÖ **–í–´–ü–û–õ–ù–ï–ù–û**: –§—É–Ω–∫—Ü–∏–∏ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω—ã –≤ Game.js
- ‚úÖ **–í–´–ü–û–õ–ù–ï–ù–û**: –§—É–Ω–∫—Ü–∏–∏ —É–¥–∞–ª–µ–Ω—ã –∏–∑ main.js (–¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —É—Å—Ç—Ä–∞–Ω–µ–Ω–æ)
- **–§–∞–π–ª—ã**: `src/main.js` (—Ñ—É–Ω–∫—Ü–∏–∏ —É–¥–∞–ª–µ–Ω—ã, —Å—Å—ã–ª–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã)
- **–ü—Ä–æ–≤–µ—Ä–∫–∞**: –§—É–Ω–∫—Ü–∏–∏ –±–æ–ª—å—à–µ –Ω–µ –¥—É–±–ª–∏—Ä—É—é—Ç—Å—è, —Å—Å—ã–ª–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã –Ω–∞ –º–µ—Ç–æ–¥—ã game.

**–í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω—ã —Å—Å—ã–ª–∫–∏ –Ω–∞ `checkArrival()` –≤ `onArrival` callback
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω—ã —Å—Å—ã–ª–∫–∏ –Ω–∞ `checkArrival()` –≤ `carEntity.update()`
- ‚úÖ –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ç–µ–ø–µ—Ä—å –≤—ã–∑—ã–≤–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ `game.checkArrival()` –≤–º–µ—Å—Ç–æ –ø—Ä—è–º—ã—Ö –≤—ã–∑–æ–≤–æ–≤

## üü° –í–ê–ñ–ù–´–ï –ó–ê–î–ê–ß–ò

### 6.1 –£–¥–∞–ª–∏—Ç—å –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ ‚úÖ (–í–´–ü–û–õ–ù–ï–ù–û)
- ‚úÖ **–í–´–ü–û–õ–ù–ï–ù–û**: –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —É–¥–∞–ª–µ–Ω—ã –∏–∑ main.js
- ‚úÖ **–í–´–ü–û–õ–ù–ï–ù–û**: –í—Å–µ –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–∞–º–µ–Ω–µ–Ω—ã –Ω–∞ –æ–±—Ä–∞—â–µ–Ω–∏—è –∫ `game.*`
- **–§–∞–π–ª—ã**: `src/main.js`
- **–ü—Ä–æ–≤–µ—Ä–∫–∞**: –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —É–¥–∞–ª–µ–Ω—ã, –≤—Å–µ —Å—Å—ã–ª–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã.

**–£–¥–∞–ª–µ–Ω–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:**
```javascript
// –£–î–ê–õ–ï–ù–´: —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Å–≤–æ–π—Å—Ç–≤–∞ game
let world, gridLayer, roadsLayer, lotsLayer, zonesLayer, labelsLayer, 
    intersectionsLayer, decorLayer, trafficLightsLayer, borderLayer, 
    uiLayer, lightingLayer, car;
let carPath = [], carSegment = 0, carProgress = 0;
let avatar;
let carTrafficController;
let pathBuilder;
let buildingAvatars = new Map();
```

**–í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- ‚úÖ –£–¥–∞–ª–µ–Ω—ã –æ–±—ä—è–≤–ª–µ–Ω–∏—è –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö (—Å—Ç—Ä–æ–∫–∏ 22-27)
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω—ã –≤—Å–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ `world` ‚Üí `game.world`
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω—ã –≤—Å–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ —Å–ª–æ–∏ ‚Üí `game.gridLayer`, `game.roadsLayer`, etc.
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω—ã —Å—Å—ã–ª–∫–∏ –Ω–∞ `carTrafficController` ‚Üí `window.carTrafficController`
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω—ã —Å—Å—ã–ª–∫–∏ –Ω–∞ `pathBuilder` ‚Üí `window.pathBuilder`
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω—ã —Å—Å—ã–ª–∫–∏ –Ω–∞ `decorLayer` ‚Üí `game.decorLayer`

### 6.3 –£–ø—Ä–æ—Å—Ç–∏—Ç—å main.js –¥–æ —Ç–æ—á–∫–∏ –≤—Ö–æ–¥–∞ ‚è≥ (–í –ü–†–û–¶–ï–°–°–ï)
- ‚è≥ **–í –ü–†–û–¶–ï–°–°–ï**: main.js —Å–æ–¥–µ—Ä–∂–∏—Ç ~500 —Å—Ç—Ä–æ–∫ (–±—ã–ª–æ 808)
- ‚è≥ **–í –ü–†–û–¶–ï–°–°–ï**: –ü–µ—Ä–µ–Ω–µ—Å–µ–Ω—ã —Ñ—É–Ω–∫—Ü–∏–∏ `getDestinationCenter()`, `initEntities()` –∏ `createCar()` –≤ Game.js
- ‚úÖ **–ù–û–í–û–ï**: –ü–µ—Ä–µ–Ω–µ—Å–µ–Ω—ã –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ `lastStayTimerUpdate` –∏ `lastStayTimerDay` –≤ Game.js
- **–§–∞–π–ª—ã**: `src/main.js`, `src/game/Game.js`
- **–ü—Ä–æ–≤–µ—Ä–∫–∞**: –§—É–Ω–∫—Ü–∏—è `getDestinationCenter()` —É—Å–ø–µ—à–Ω–æ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–∞, –≤—Å–µ —Å—Å—ã–ª–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã.

**–í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- ‚úÖ –ü–µ—Ä–µ–Ω–µ—Å–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `getDestinationCenter()` –≤ `Game.js` –∫–∞–∫ `_getDestinationCenter()`
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã `_getVerticalRoadXs()` –∏ `_getHorizontalRoadYs()`
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω—ã –≤—Å–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ `window.getDestinationCenter` ‚Üí `this._getDestinationCenter`
- ‚úÖ –£–¥–∞–ª–µ–Ω—ã —Ñ—É–Ω–∫—Ü–∏–∏ `getVerticalRoadXs()` –∏ `getHorizontalRoadYs()` –∏–∑ main.js
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω—ã –≤—Å–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ —ç—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –≤ main.js
- ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û**: –î–æ–±–∞–≤–ª–µ–Ω–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è `this.zoneGeometry` –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä Game.js
- ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û**: –û–±–Ω–æ–≤–ª–µ–Ω—ã –≤—Å–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ `zoneGeometry` –≤ main.js ‚Üí `game.zoneGeometry`
- ‚úÖ **–ù–û–í–û–ï**: –ü–µ—Ä–µ–Ω–µ—Å–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `initEntities()` –≤ `Game.js` –∫–∞–∫ `_initEntities()`
- ‚úÖ **–ù–û–í–û–ï**: –û–±–Ω–æ–≤–ª–µ–Ω—ã –≤—Å–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ `carEntity` –∏ `shinaEntity` –≤ main.js ‚Üí `game.carEntity` –∏ `game.shinaEntity`
- ‚úÖ **–ù–û–í–û–ï**: –£–¥–∞–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `initEntities()` –∏–∑ main.js
- ‚úÖ **–ù–û–í–û–ï**: –ü–µ—Ä–µ–Ω–µ—Å–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `createCar()` –≤ `Game.js` –∫–∞–∫ `_createCar()`
- ‚úÖ **–ù–û–í–û–ï**: –î–æ–±–∞–≤–ª–µ–Ω—ã –∏–º–ø–æ—Ä—Ç—ã `CarRenderer`, `CarTrafficController`, `PathBuilder` –≤ Game.js
- ‚úÖ **–ù–û–í–û–ï**: –û–±–Ω–æ–≤–ª–µ–Ω –≤—ã–∑–æ–≤ –≤ main.js –Ω–∞ `game._createCar()` —Å –ø–æ–ª—É—á–µ–Ω–∏–µ–º `carRenderer`
- ‚úÖ **–ù–û–í–û–ï**: –£–¥–∞–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `createCar()` –∏–∑ main.js
- ‚úÖ **–ù–û–í–û–ï**: –ü–µ—Ä–µ–Ω–µ—Å–µ–Ω—ã –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ `lastStayTimerUpdate` –∏ `lastStayTimerDay` –≤ Game.js –∫–∞–∫ —Å–≤–æ–π—Å—Ç–≤–∞ –∫–ª–∞—Å—Å–∞
- ‚úÖ **–ù–û–í–û–ï**: –û–±–Ω–æ–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `updateStayTimer()` –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `this.lastStayTimerUpdate` –∏ `this.lastStayTimerDay`
- ‚úÖ **–ù–û–í–û–ï**: –£–¥–∞–ª–µ–Ω—ã –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ `lastStayTimerUpdate` –∏ `lastStayTimerDay` –∏–∑ main.js

**–¶–µ–ª—å**: –û—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ –∏–º–ø–æ—Ä—Ç—ã –∏ `const game = new Game(); game.start();`

## üü¢ –°–†–ï–î–ù–ò–ï –ó–ê–î–ê–ß–ò 

### 5.1-5.4 –û—á–∏—Å—Ç–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –æ—Ç –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö ‚è≥ (–ü–õ–ê–ù–ò–†–£–ï–¢–°–Ø)
- –ü–µ—Ä–µ–¥–∞—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —á–µ—Ä–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤–º–µ—Å—Ç–æ `window.*`
- –û–±–Ω–æ–≤–∏—Ç—å `DayNightManager` –∏ `UIRenderer`
- –£–±—Ä–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `window.carEntity`, `window.world` –∏ –¥—Ä—É–≥–∏—Ö –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è –∑–∞–¥–∞—á
- **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ**: 0 –∑–∞–¥–∞—á ‚úÖ (—É–¥–∞–ª–µ–Ω–∏–µ –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π –∑–∞–≤–µ—Ä—à–µ–Ω–æ)
- **–í–∞–∂–Ω—ã–µ**: 1 –∑–∞–¥–∞—á–∞ ‚è≥ (—É–ø—Ä–æ—â–µ–Ω–∏–µ main.js - –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ)
- **–°—Ä–µ–¥–Ω–∏–µ**: 1 –∑–∞–¥–∞—á–∞ (–æ—á–∏—Å—Ç–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π)
- **–í—Å–µ–≥–æ –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è**: 2 –∑–∞–¥–∞—á–∏

## üéØ –ö—Ä–∏—Ç–µ—Ä–∏–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
- [x] –í—Å–µ –¥—É–±–ª–∏—Ä—É—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ —É–¥–∞–ª–µ–Ω—ã –∏–∑ main.js ‚úÖ
- [x] –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —É–¥–∞–ª–µ–Ω—ã –∏–∑ main.js ‚úÖ
- [ ] main.js —É–ø—Ä–æ—â–µ–Ω –¥–æ —Ç–æ—á–∫–∏ –≤—Ö–æ–¥–∞ (< 10 —Å—Ç—Ä–æ–∫)
- [ ] –ò–≥—Ä–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –æ—à–∏–±–æ–∫
- [ ] –ö–æ–¥ –≥–æ—Ç–æ–≤ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É
