# Структура слоев PIXI.js в игре

## Иерархия слоев (сверху вниз):

```
app.stage
├── uiLayer (zIndex: 2000) - UI элементы
├── lightingLayer (zIndex: 1000) - Источники света (не используется для светофоров)
└── world
    ├── trafficLightsLayer - Светофоры (ПОВЕРХ затемнения!)
    ├── decorLayer - Машина и декорации (ПОВЕРХ затемнения!)
    ├── cityNightOverlay (zIndex: 400) - Затемнение только для города
    ├── borderLayer - Границы мира
    ├── labelsLayer - Подписи
    ├── zonesLayer - Зоны (дома, работа, институт)
    ├── lotsLayer - Участки земли
    ├── intersectionsLayer - Перекрестки
    ├── roadsLayer - Дороги
    └── gridLayer - Сетка
```

## Ключевые особенности:

1. **cityNightOverlay** - единственный слой затемнения, применяется только к городским элементам
2. **Порядок слоев** - машина (decorLayer) и светофоры (trafficLightsLayer) рендерятся поверх затемнения
3. **Упрощенная архитектура** - убран дублирующий код, оставлен только необходимый функционал

## Эффект:

- ✅ Город/дома затемняются ночью
- ✅ Машина остается яркой и видимой
- ✅ Светофоры светятся поверх затемнения
- ✅ Плавные переходы между днем и ночью
- ✅ Чистый код без дублирования
